<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>QRGen</title>
  <link rel="icon" type="image/jpg" href="Pro.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    :root{ --footer-height: 64px; }
    body {
      margin: 0;
      font-family: 'Inter', sans-serif;
      background: linear-gradient(135deg, #f0f9ff 0%, #eef2ff 100%);
      min-height: 100vh;
      display: flex;
      flex-direction: column;
    }

    /* navbar */
    nav { position: fixed; top:0; left:0; right:0; z-index:30; background: white; box-shadow: 0 1px 6px rgba(0,0,0,0.06); }

    /* main container */
    .main-container {
      width: 100%;
      max-width: 1100px;
      margin: 0 auto;
      padding: 20px 16px;
      box-sizing: border-box;
      padding-top: 96px; /* space for navbar */
      padding-bottom: calc(var(--footer-height) + 24px); /* space for footer */
      flex: 1 0 auto;
    }

    /* WhatsApp buttons */
    .whatsapp-btn {
      width: 46px; height: 46px; border-radius: 12px;
      background: #25D366; color: white; display: flex;
      justify-content: center; align-items: center;
      box-shadow: 0 6px 18px rgba(0,0,0,.18); transition: 0.18s;
      z-index: 40;
    }
    .whatsapp-btn:hover{ transform: scale(1.06); }

    @keyframes beat { 0%{transform:scale(1)}50%{transform:scale(1.07)}100%{transform:scale(1)} }
    .beat{ animation: beat 2s infinite; }

    /* loader bars for QR form */
    .bars { display:flex; gap:6px; justify-content:center; margin-top:10px; }
    .bar{ width:6px; height:12px; background:#6366f1; animation:pulse 1s infinite; border-radius:4px; }
    @keyframes pulse { 0%,100%{height:12px;} 50%{height:48px;} }

    /* footer */
    footer {
      background: #111827;
      color: white;
      height: var(--footer-height);
      display:flex;
      align-items:center;
      justify-content:center;
      padding: 0 12px;
      box-sizing: border-box;
      flex-shrink: 0;
    }
    @media (max-width: 768px) {
      footer {
        position: fixed;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 35;
      }
    }

    /* QR loading overlay */
    .loading-overlay {
      position: absolute;
      inset: 0;
      background: rgba(255,255,255,0.85);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 20;
    }

    /* small adjustments */
    #qrOutput .qr-placeholder { min-height: 220px; display:flex; align-items:center; justify-content:center; }

    /* Toast (success message) */
    .toast {
      position: fixed;
      right: 16px;
      bottom: calc(var(--footer-height) + 24px);
      background: #16a34a; /* green */
      color: white;
      padding: 12px 16px;
      border-radius: 10px;
      box-shadow: 0 8px 24px rgba(22,163,74,0.18);
      display: flex;
      align-items: center;
      gap: 10px;
      z-index: 9999;
      transform: translateY(10px);
      opacity: 0;
      transition: transform 240ms ease, opacity 240ms ease;
      font-weight: 600;
    }
    .toast.show { transform: translateY(0); opacity: 1; }

    /* small icon inside toast */
    .toast .icon { font-size: 18px; }
  </style>
</head>
<body>

  <!-- NAVBAR -->
  <nav>
    <div class="max-w-7xl mx-auto px-4 h-16 flex justify-between items-center">
      <span class="text-xl font-bold text-indigo-600">Pro <span class="text-gray-800">Developing.</span></span>
      <a id="waTop" class="whatsapp-btn beat" title="Chat on WhatsApp" href="#" role="button">
        <i class="fa-brands fa-whatsapp fa-lg"></i>
      </a>
    </div>
  </nav>

  <!-- MAIN CONTENT -->
  <main class="main-container">
    <div class="max-w-4xl mx-auto">
      <div class="text-center mb-8">
        <h2 class="text-3xl md:text-4xl font-bold text-gray-800 mb-3">Generate QR Codes Instantly</h2>
        <p class="text-gray-600 max-w-lg mx-auto">
          Create custom QR codes for URLs, text, or contact information in seconds.
          Unlimited downloads, no registration required.
        </p>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <!-- Form -->
        <div class="bg-white rounded-xl shadow-md p-6 relative">
          <!-- Animation container (hidden by default) -->
          <div id="loadingAnimation" class="hidden loading-overlay" aria-hidden="true">
            <div class="bars" aria-hidden="true">
              <div class="bar" style="animation-delay:0s"></div>
              <div class="bar" style="animation-delay:0.08s"></div>
              <div class="bar" style="animation-delay:0.16s"></div>
              <div class="bar" style="animation-delay:0.24s"></div>
              <div class="bar" style="animation-delay:0.32s"></div>
            </div>
          </div>

          <form id="qrForm" class="space-y-4">
            <div>
              <label for="qrContent" class="block text-sm font-medium text-gray-700 mb-1">Content to encode</label>
              <input type="text" id="qrContent" placeholder="Enter URL or text..."
                class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition" required>
            </div>

            <div class="grid grid-cols-2 gap-4">
              <div>
                <label for="qrColor" class="block text-sm font-medium text-gray-700 mb-1">Color</label>
                <select id="qrColor" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                  <option value="#000000">Black</option>
                  <option value="#1E40AF">Blue</option>
                  <option value="#B91C1C">Red</option>
                  <option value="#047857">Green</option>
                </select>
              </div>
              <div>
                <label for="qrSize" class="block text-sm font-medium text-gray-700 mb-1">Size</label>
                <select id="qrSize" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                  <option value="1">Small</option>
                  <option value="2" selected>Medium</option>
                  <option value="3">Large</option>
                </select>
              </div>
            </div>

            <div>
              <label for="qrErrorCorrection" class="block text-sm font-medium text-gray-700 mb-1">Error Correction</label>
              <select id="qrErrorCorrection" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition">
                <option value="L">Low (~7%)</option>
                <option value="M" selected>Medium (~15%)</option>
                <option value="Q">Quartile (~25%)</option>
                <option value="H">High (~30%)</option>
              </select>
            </div>

            <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition duration-300 transform hover:-translate-y-1">
              Generate QR Code
            </button>
          </form>
        </div>

        <!-- QR Output -->
        <div class="bg-white rounded-xl shadow-md p-6">
          <div class="flex flex-col h-full">
            <h3 class="text-xl font-semibold text-gray-800 mb-4">Your QR Code</h3>
            <div id="qrOutput" class="flex-grow flex items-center justify-center">
              <div class="qr-placeholder w-full">
                <p class="text-gray-400">Your QR code will appear here</p>
              </div>
            </div>

            <div id="qrActions" class="hidden mt-6 space-x-3 flex justify-center">
              <button id="downloadSvg" class="bg-indigo-600 hover:bg-indigo-700 text-white font-medium py-2 px-5 rounded-lg">
                Download SVG
              </button>
              <button id="downloadPng" class="bg-gray-800 hover:bg-gray-900 text-white font-medium py-2 px-5 rounded-lg">
                Download PNG
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>

  <!-- Footer -->
  <footer>
    <div class="max-w-7xl w-full mx-auto text-center text-sm">
      © Powered by <a href="https://www.prodeveloping.online/" target="_blank" class="underline text-indigo-400">Pro Developing.</a>
    </div>
  </footer>

  <!-- Floating WhatsApp (bottom-right) -->
  <a id="waFloating" class="whatsapp-btn beat" href="#" style="position:fixed; right:16px; bottom: calc(var(--footer-height) + 16px); z-index:45;" title="Chat on WhatsApp">
    <i class="fa-brands fa-whatsapp fa-2x"></i>
  </a>

  <!-- Toast -->
  <div id="toast" class="toast" role="status" aria-live="polite" aria-atomic="true" style="display:none;">
    <span class="icon">✔</span>
    <span class="message">QR Code Downloaded Successfully!</span>
  </div>

<script>
  // Use the provided WhatsApp number (with country code). User number: 6356952788 -> +91
  const waNumber = '916356952788'; // +91 6356952788
  const waMessage = encodeURIComponent('Hello! I found your site via QRGen.');

  // Top navbar WA
  document.getElementById('waTop').addEventListener('click', (e)=>{
    e.preventDefault();
    window.open(`https://wa.me/${waNumber}?text=${waMessage}`, '_blank');
  });
  // Floating WA
  document.getElementById('waFloating').addEventListener('click', (e)=>{
    e.preventDefault();
    window.open(`https://wa.me/${waNumber}?text=${waMessage}`, '_blank');
  });

  // Toast helper
  let toastTimer = null;
  function showToast(msg = 'QR Code Downloaded Successfully!', duration = 3000) {
    const t = document.getElementById('toast');
    t.querySelector('.message').textContent = msg;
    t.style.display = 'flex';
    // small delay to allow CSS transition
    requestAnimationFrame(() => t.classList.add('show'));
    // clear previous timer
    if (toastTimer) clearTimeout(toastTimer);
    toastTimer = setTimeout(() => {
      t.classList.remove('show');
      // after transition hide completely
      setTimeout(() => { t.style.display = 'none'; }, 260);
    }, duration);
  }

  // QR generator logic
  const form = document.getElementById('qrForm');
  const loading = document.getElementById('loadingAnimation');

  form.addEventListener('submit', function(e) {
    e.preventDefault();
    loading.classList.remove('hidden');

    const content = document.getElementById('qrContent').value.trim();
    const color = document.getElementById('qrColor').value;
    // map size selection to typeNumber (kept similar to your original logic)
    const typeNumber = parseInt(document.getElementById('qrSize').value) * 2 + 2;
    const errorCorrectionLevel = document.getElementById('qrErrorCorrection').value;

    setTimeout(() => {
      if (content) {
        generateQRCode(content, color, typeNumber, errorCorrectionLevel);
      } else {
        // no content
        document.getElementById('qrOutput').innerHTML = '<div class="qr-placeholder w-full"><p class="text-gray-400">Please enter content to generate QR.</p></div>';
        document.getElementById('qrActions').classList.add('hidden');
      }
      loading.classList.add('hidden');
    }, 700);
  });

  let lastGeneratedQR = null; // store the last qr object so downloads work reliably

  function generateQRCode(content, color, typeNumber, errorCorrectionLevel) {
    const qr = qrcode(typeNumber, errorCorrectionLevel);
    qr.addData(content);
    qr.make();
    lastGeneratedQR = qr;
    const container = document.getElementById('qrOutput');
    container.innerHTML = qr.createSvgTag(8, 0);
    // colorize all svg path elements (some implementations use rects; original library used path)
    const svg = container.querySelector('svg');
    if (svg) {
      // set background white for better visibility
      svg.setAttribute('style', 'background: white; padding: 8px; border-radius: 8px; max-width:100%; height:auto;');
      // change dark modules color
      const paths = svg.querySelectorAll('path');
      if (paths.length) {
        paths.forEach(p => p.setAttribute('fill', color));
      } else {
        // fallback: change fill on svg child rects
        const rects = svg.querySelectorAll('rect');
        rects.forEach(r => {
          if (r.getAttribute('fill') === '#000000' || r.getAttribute('fill') === 'black') {
            r.setAttribute('fill', color);
          }
        });
      }
    }
    document.getElementById('qrActions').classList.remove('hidden');
    setupDownloadButtons(qr, color);
  }

  function setupDownloadButtons(qr, color) {
    document.getElementById('downloadSvg').onclick = function() {
      try {
        const svgData = qr.createSvgTag(8, 0);
        const svgBlob = new Blob([svgData], {type: 'image/svg+xml;charset=utf-8'});
        const svgUrl = URL.createObjectURL(svgBlob);
        const downloadLink = document.createElement('a');
        downloadLink.href = svgUrl;
        downloadLink.download = 'qr-code.svg';
        document.body.appendChild(downloadLink);
        downloadLink.click();
        document.body.removeChild(downloadLink);
        // revoke after short delay
        setTimeout(() => URL.revokeObjectURL(svgUrl), 1000);

        // show success toast
        showToast('✔ QR Code Downloaded Successfully!');
      } catch (err) {
        console.error(err);
      }
    };

    document.getElementById('downloadPng').onclick = function() {
      try {
        // if qr not present try using lastGeneratedQR
        const currentQr = qr || lastGeneratedQR;
        if (!currentQr) {
          alert('Please generate a QR code first.');
          return;
        }
        const canvas = document.createElement('canvas');
        const size = currentQr.getModuleCount() * 8;
        canvas.width = size;
        canvas.height = size;
        const ctx = canvas.getContext('2d');
        ctx.fillStyle = '#ffffff';
        ctx.fillRect(0, 0, size, size);
        const modules = currentQr.getModuleCount();
        for (let row = 0; row < modules; row++) {
          for (let col = 0; col < modules; col++) {
            if (currentQr.isDark(row, col)) {
              ctx.fillStyle = color;
              ctx.fillRect(col * 8, row * 8, 8, 8);
            }
          }
        }
        canvas.toBlob(function(blob) {
          const pngUrl = URL.createObjectURL(blob);
          const downloadLink = document.createElement('a');
          downloadLink.href = pngUrl;
          downloadLink.download = 'qr-code.png';
          document.body.appendChild(downloadLink);
          downloadLink.click();
          document.body.removeChild(downloadLink);
          setTimeout(() => URL.revokeObjectURL(pngUrl), 1000);

          // show success toast
          showToast('✔ QR Code Downloaded Successfully!');
        });
      } catch (err) {
        console.error(err);
      }
    };
  }
</script>
</body>
</html>
